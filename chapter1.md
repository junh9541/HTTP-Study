# Chapter 1

## http 개관

> 전 세계의 웹브라우저, 서버 등은 모두 HTTP 프로토콜을 통해 통신하고 데이터를 전달한다.

1장은 다음의 내용을 다룬다.

- http 요청/응답 메세지
- 다양한 유형의 리소스
- 미디어 타입
- URI / URL / URN
- http 메서드
- 상태코드
- http 메세지 구조
- TCP/IP
- IP / 포트 번호
- http 프로토콜 버전
- 웹 구성요소
  <br>
  <br>

> http는 어떻게 작동할까?

HTTP는 기본적으로 요청과 응답으로 이루어진다.  
클라이언트는 http를 통해 서버에 데이터를 요청하고, 서버는 요청된 데이터를 http 응답으로 돌려준다.  
<br>
구체적인 예시는 다음과 같다.

1. 사용자는 "http:www.oreilly.com/index.html" 페이지에 접속한다.

2. 웹브라우저는 HTTP 요청을 www/oreilly.com 서버로 보낸다.

3. 서버는 요청받은 객체("/index/html)을 찾고 객체의 정보를 포함시켜 HTTP 응답을 클라이언트에 보낸다.  
   <br>

> 리소스는 무엇인가?

리소스는 웹 서버가 관리하고 제공하는 웹 콘텐츠를 종합하여 부르는 말이다.
<br>  
텍스트, 이미지, 마이크로소프트 워드, 프레젠테이션 등의 정적인 파일 뿐만 아니라 프로그램, 웹 게이트웨이, 인터넷 검색 엔진 등 모든 콘텐츠 소스를 포괄적으로 지칭한다.  
<br>

> 미디어 타입 (MIME)

서버는 MIME 타입이라는 데이터 포맷 라벨을 붙여 HTTP를 통해 전송하는 데이터의 타입을 구분한다.

MIME타입은 모든 HTTP 객체 데이터에 각각 붙는다.

MIME은 문자열 라벨로, "/"를 기준으로 주 타입과 부 타입으로 구분된다.

- HTML: text/html
- GIF: image/gif
- 애플 퀵타임 동영상: video/quicktime

> URI / URL / URN

**URI(Uniform Resource Identifier)**  
클라이언트가 특정 리소스를 요청 할 때 URI로 리소스의 이름 혹은 위치를 식별할 수 있다.

URI은 URL과 URN으로 구분된다.

**URL(Uniform Resource Locator)**  
URL은 특정 서버의 리소스에 대한 구체적인 위치를 나타낸다.

```
http:www.oreilly.com/index.html
http:www.joes-hardware.com/inventory-check.cgi?item=12731
```

URL은 기본적으로 스킴, 서버 주소, 리소스 주소 세 부분으로 이루어진다.

"http://" 첫 번째 부분은 스킴이다. 스킴은 리소스에 접근하기 위한 프로토콜을 말한다.  
"www.oreilly.com" 두 번째 부분은 서버 인터넷 주소다.  
"/index.html" 세 번째 부분은 리소스의 위치를 가리킨다.

**URN(Uniform resource Name)**  
URN은 리소스의 유일한 이름이다.  
URN이 유지된다면 리소스의 위치가 변경되거나 다른 프로토콜로 접근해도 리소스를 찾을 수 있다.

그러나 URN은 상용화되지 않아 현재 URI은 곧 URL을 의미한다.

## HTTP 메세지

> 트랜잭션

- 클라이언트->서버로의 요청명령
- 서버->클라이언트로의 응답결과

HTTP 트랜잭션은 위의 두 가지 HTTP 메세지로 이뤄진다.

> HTTP 메서드

모든 HTTP 요청 메세지에 하나의 HTTP 메서드가 포함된다.  
 매서드|설명
---|---
get|서버에서 클라이언트로 지정한 리소스를 전송하라
put|클라이언트에서 서버로 보낸 데이터를 지정한 이름의 리소스로 저장하라
delete|지정한 리소스를 서버에서 삭제하라
post|클라이언트 데이터를 서버 게이트웨이 애플리케이션으로 보내라
head|정한 리소스에 대한 응답에서 HTTP 헤더 부분만 보내라.

> 상태 코드

모든 HTTP 응답 메세지는 요청에 대한 상태 코드와 함께 반환된다.  
상태 코드는 3자리 숫자로 구성된다.

| 상태코드 | 설명                           |
| -------- | ------------------------------ |
| 200      | 문제 없음                      |
| 302      | 다른 곳에서 리소스 재요청 바람 |
| 404      | 리소스를 찾을 수 없음          |

> HTTP 메세지 구조

HTTP 메세지는 시작줄, 헤더, 본문으로 구성된 일반 텍스트 문자열이다.  
요청 메세지와 응답 메세지의 구성은 유사하다.

- 시작줄: 메세지의 첫 줄. 요청-무엇을 할지 응답-무슨 일이 일어났는지 나타낸다.
- 헤더: ":"로 구분되는 이름-값 쌍으로 구성된다. 한 줄을 추가하여 헤더 필드를 추가할 수 있다.  
  빈 줄로 헤더를 끝낸다.
- 본문: 어떤 데이터든 담아 클라이언트에 반환된다. 이진데이터를 포함할 수 있다.

## TCP/IP 접속

> TCP/IP

HTTP는 TCP/IP 프로토콜을 통해 신뢰성있는 통신을 제공한다.  
HTTP는 네트워크 계층 프로토콜, TCP/IP는 인터넷 전송 프로토콜이다.

TCP/IP는 전송 계층의 TCP와 네트워크 계층의 IP의 집합이다.  
이를 통해 각 네트워크와 하드웨어의 특성을 숨기며 TCP 커넥션을 통한 신뢰성 있는 통신을 제공한다.

> 접속, IP주소, 포트 번호

HTTP로 메세지를 전송하기 이전에 클라이언트와 서버는 TCP/IP 커넥션을 맺어야 한다.

TCP/IP 커넥션은 URL의 IP 주소와 포트 번호로 설정한다.  
IP 주소는 서버 컴퓨터의 주소, 포트 번호는 서버에서 실행되는 프로그램이 사용하는 포트번호다.

```
http://207.200.83.29:80/index.html
http://www.netscape.com:80/index.html
http://www.netscape.com/index.html
```

첫 번째 URL은 IP 주소, 포트번호가 명시되어 있다.  
두 번째 URL은 IP 주소 대신 도메인 이름을 가진다. 도메인 이름은 DNS 서버를 거쳐 IP 주소로 변환된다.
세 번째 URL은 포트 번호가 없다. 포트 번호가 없다면 기본값 80으로 간주한다.

## 프로토콜 버전

| HTTP 버전 |                                                                       |
| --------- | --------------------------------------------------------------------- |
| HTTP/0.9  | get 메소드만 지원/MIME 없음/HTTP 헤더 없음/버전 번호 없음             |
| HTTP/1.0  | 버전 번호, HTTP 헤더, 추가 메서드, 멀티미디어 객체 처리 추가          |
| HTTP/1.0  | keep-alive 커넥션, 가상 호스팅 지원 등 여러 기능 추가된 1.0 확장 버전 |
| HTTP/1.1  | 구조적 결함 교정, 성능 최적화, 잘못된 기능 제거/현재의 HTTP 버전      |
| HTTP/2.0  | HTTP/1.1의 성능 문제를 새건하기 위해 설계 진행 중인 프로토콜          |

## 웹 구성요소

지금까지 웹 애플리케이션(웹 브라우저-웹 서버) 간의 메세지 전달에 대해 알아보았다.  
마지막으로 다양한 웹 애플리케이션에 대해 알아본다.

> 프락시: 클라이언트-서버 사이의 HTTP 중개자

프락시는 클라이언트에게 HTTP 요청을 받아 서버에 전달한다.  
중개자 역할로 보안을 위해 사용된다.  
요청과 응답을 필터링하여 바이러스를 검출하거나 특정 요청/응답을 차단한다.

> 캐시: 자주 쓰이는 페이지 저장 창고

HTTP 프락시 서버의 일종이다. 프락시를 자주 거쳐가는 문서의 사본을 저장한다.  
클라이언트가 해당 문서를 요청하면 웹 서버를 통하는 것 보다 빠르게 문서를 전달한다.  
HTTP에는 캐시가 적절히 동작하기 위한 기능을 제공한다.(7장 다룸)

> 게이트웨이

다른 서버(e.g. HTTP-FTP)간에서 중개자로 동작하며 HTTP를 다른 프로토콜로 변환한다.  
게이트웨이는 서버처럼 동작한다. 클라이언트 측에서는 게이트웨이의 존재를 알 수 없다.

> 터널: http 전달 프락시

커넥션 사이에서 데이터를 열어보지 않고 그대로 전달해주는 애플리케이션이다.  
비 http 데이터를 하나 의상의 http 연결로 그대로 전송할 때 사용한다.  
(e.g. 사내에서 암호화된 SSL 트래픽을 HTTP 커넥션으로 전송해 웹 트래픽만 허용하는 사내 방화벽을 통과)

> 에이전트: HTTP 요청 만드는 클라이언트 프로그램

웹 브라우저 외에도 다양한 에이전트가 있다. 스스로 웹을 돌아다니며 HTTP 트랜잭션을 일으켜 정보를 수집하는 자동화 에이전트(스파이더, 웹로봇)이 그 예다.(9장 다룸)
